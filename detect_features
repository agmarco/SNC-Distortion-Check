#!/usr/bin/env python
import sys

import scipy.io

from feature_detection import FeatureDetector


if __name__ == '__main__':
    if len(sys.argv) != 3:
        print('Usage: detectfeatures INPUTMAT OUTPUTMAT')
        sys.exit(1)

    input_data = scipy.io.loadmat(sys.argv[1])
    voxels = input_data['voxels']
    ijk_to_patient_xyz_transform = input_data['ijk_to_patient_xyz_transform']

    points_in_patient_xyz = FeatureDetector(voxels, ijk_to_patient_xyz_transform).run()

    output_mat_filename = sys.argv[2]
    scipy.io.savemat(output_mat_filename, {'points': points_in_patient_xyz})
